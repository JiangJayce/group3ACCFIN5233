# -*- coding: utf-8 -*-
from iFinDPy import *
from datetime import datetime
import pandas as pd
import time as _time

def thslogindemo(): # Enter the user's account and password
  thsLogin = THS_iFinDLogin("bjrld006","5176npcNPC")
  print(thsLogin)
  if thsLogin != 0:
    print('Login Failure')
  else:
    print('Login Successful')


def historyReportDateTest():
    dataList=THS_DS('000021.SZ,000078.SZ,000411.SZ,000518.SZ,000521.SZ,000541.SZ,000566.SZ,000650.SZ,000657.SZ,000705.SZ,000710.SZ,000725.SZ,000788.SZ,000790.SZ,000795.SZ,000881.SZ,000887.SZ,000908.SZ,000919.SZ,000925.SZ,000948.SZ,000950.SZ,000955.SZ,000963.SZ,000972.SZ,001328.SZ,001368.SZ,002020.SZ,002022.SZ,002030.SZ,002082.SZ,002086.SZ,002093.SZ,002105.SZ,002111.SZ,002131.SZ,002144.SZ,002160.SZ,002165.SZ,002173.SZ,002178.SZ,002198.SZ,002223.SZ,002294.SZ,002301.SZ,002307.SZ,002317.SZ,002338.SZ,002362.SZ,002382.SZ,002390.SZ,002398.SZ,002420.SZ,002422.SZ,002424.SZ,002432.SZ,002456.SZ,002462.SZ,002486.SZ,002551.SZ,002560.SZ,002579.SZ,002589.SZ,002614.SZ,002636.SZ,002653.SZ,002690.SZ,002698.SZ,002723.SZ,002727.SZ,002735.SZ,002747.SZ,002773.SZ,002788.SZ,002793.SZ,002795.SZ,002796.SZ,002808.SZ,002817.SZ,002822.SZ,002848.SZ,002861.SZ,002864.SZ,002898.SZ,002900.SZ,002901.SZ,002923.SZ,002925.SZ,002932.SZ,002935.SZ,002950.SZ,002980.SZ,002981.SZ,003021.SZ,003023.SZ,003043.SZ,020548.SXGQS,300003.SZ,300006.SZ,300009.SZ,300015.SZ,300018.SZ,300024.SZ,300026.SZ,300030.SZ,300039.SZ,300049.SZ,300110.SZ,300143.SZ,300147.SZ,300165.SZ,300169.SZ,300171.SZ,300195.SZ,300206.SZ,300238.SZ,300244.SZ,300246.SZ,300247.SZ,300254.SZ,300288.SZ,300289.SZ,300298.SZ,300300.SZ,300314.SZ,300318.SZ,300326.SZ,300328.SZ,300337.SZ,300341.SZ,300347.SZ,300357.SZ,300390.SZ,300396.SZ,300406.SZ,300412.SZ,300430.SZ,300439.SZ,300451.SZ,300453.SZ,300482.SZ,300485.SZ,300529.SZ,300534.SZ,300549.SZ,300562.SZ,300563.SZ,300595.SZ,300633.SZ,300642.SZ,300653.SZ,300676.SZ,300677.SZ,300678.SZ,300685.SZ,300753.SZ,300760.SZ,300812.SZ,300813.SZ,300828.SZ,300832.SZ,300869.SZ,300888.SZ,300896.SZ,300916.SZ,300942.SZ,300957.SZ,300964.SZ,300981.SZ,301009.SZ,301013.SZ,301015.SZ,301021.SZ,301033.SZ,301087.SZ,301093.SZ,301097.SZ,301122.SZ,301126.SZ,301135.SZ,301163.SZ,301188.SZ,301196.SZ,301225.SZ,301230.SZ,301234.SZ,301235.SZ,301258.SZ,301263.SZ,301286.SZ,301290.SZ,301320.SZ,301363.SZ,301367.SZ,301370.SZ,301371.SZ,301383.SZ,301408.SZ,301469.SZ,301502.SZ,301515.SZ,301538.SZ,301559.SZ,301566.SZ,301580.SZ,301591.SZ,301602.SZ,301611.SZ,430300.BJ,600055.SH,600056.SH,600079.SH,600080.SH,600129.SH,600135.SH,600143.SH,600156.SH,600196.SH,600206.SH,600207.SH,600211.SH,600223.SH,600227.SH,600243.SH,600252.SH,600278.SH,600332.SH,600336.SH,600518.SH,600525.SH,600529.SH,600538.SH,600587.SH,600628.SH,600651.SH,600671.SH,600679.SH,600718.SH,600736.SH,600774.SH,600807.SH,600829.SH,600839.SH,600855.SH,600881.SH,600981.SH,600998.SH,601089.SH,601515.SH,601607.SH,603075.SH,603087.SH,603108.SH,603111.SH,603118.SH,603205.SH,603222.SH,603233.SH,603296.SH,603301.SH,603309.SH,603380.SH,603386.SH,603387.SH,603398.SH,603626.SH,603648.SH,603658.SH,603665.SH,603666.SH,603681.SH,603716.SH,603718.SH,603733.SH,603788.SH,603811.SH,603858.SH,603880.SH,603882.SH,603883.SH,603976.SH,603987.SH,605288.SH,605369.SH,688013.SH,688016.SH,688026.SH,688029.SH,688050.SH,688067.SH,688068.SH,688085.SH,688102.SH,688108.SH,688114.SH,688139.SH,688151.SH,688161.SH,688193.SH,688195.SH,688198.SH,688212.SH,688217.SH,688236.SH,688271.SH,688277.SH,688298.SH,688301.SH,688306.SH,688310.SH,688314.SH,688315.SH,688317.SH,688329.SH,688338.SH,688351.SH,688356.SH,688358.SH,688389.SH,688399.SH,688410.SH,688426.SH,688468.SH,688510.SH,688559.SH,688575.SH,688576.SH,688580.SH,688581.SH,688600.SH,688606.SH,688613.SH,688622.SH,688626.SH,688677.SH,688678.SH,688716.SH,688767.SH,832278.BJ,832491.BJ,832982.BJ,835892.BJ,836504.BJ,870199.BJ,872925.BJ,873593.BJ,873693.BJ','ths_close_price_stock','100','','2024-09-06','2025-03-06')
    df=pd.DataFrame(dataList.data)
    df.to_csv('sector_data.csv',index=False)
    
thslogindemo()   
historyReportDateTest()
